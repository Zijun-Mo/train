# é¡¹ç›®æ–‡ä»¶ç»“æ„æ€»è§ˆ

```
train/
â”œâ”€â”€ README.md                    # é¡¹ç›®æ¦‚è¿°å’Œæ¶æ„è¯´æ˜
â”œâ”€â”€ USAGE.md                     # è¯¦ç»†ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ config.yaml                  # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt             # Pythonä¾èµ–åŒ…
â”œâ”€â”€ install.sh                   # ç¯å¢ƒå®‰è£…è„šæœ¬
â”œâ”€â”€ main.py                      # ä¸»è®­ç»ƒè„šæœ¬
â”œâ”€â”€ test_components.py           # ç»„ä»¶æµ‹è¯•è„šæœ¬
â”‚
â”œâ”€â”€ models/                      # æ¨¡å‹å®šä¹‰æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ face_blendshapes.py      # TFLiteæ¨¡å‹åŒ…è£…å™¨
â”‚   â”œâ”€â”€ optical_flow_model.py    # å…‰æµæ¨¡å‹(ResNet-18)
â”‚   â”œâ”€â”€ landmark_model.py        # å…³é”®ç‚¹æ¨¡å‹(å…¨è¿æ¥)
â”‚   â””â”€â”€ fusion_model.py          # èåˆæ¨¡å‹
â”‚
â”œâ”€â”€ data/                        # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ dataset.py               # æ•°æ®é›†ç±»å®šä¹‰
â”‚   â””â”€â”€ transforms.py            # æ•°æ®é¢„å¤„ç†å’Œå¢å¼º
â”‚
â”œâ”€â”€ training/                    # è®­ç»ƒæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ trainer.py               # ä¸»è®­ç»ƒå™¨ç±»
â”‚   â””â”€â”€ utils.py                 # è®­ç»ƒå·¥å…·å‡½æ•°
â”‚
â””â”€â”€ utils/                       # é€šç”¨å·¥å…·æ¨¡å—
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ config.py                # é…ç½®æ–‡ä»¶è§£æ
    â””â”€â”€ metrics.py               # è¯„ä¼°æŒ‡æ ‡è®¡ç®—
```

## æ ¸å¿ƒåŠŸèƒ½è¯´æ˜

### ğŸ¯ ä¸»è¦ç‰¹æ€§
- **å¤šé˜¶æ®µè®­ç»ƒç­–ç•¥**ï¼šä»é¢„è®­ç»ƒåˆ°ç«¯åˆ°ç«¯å¾®è°ƒ
- **å¤šæ¨¡æ€èåˆ**ï¼šç»“åˆå…‰æµå’Œå…³é”®ç‚¹ç‰¹å¾
- **çµæ´»é…ç½®**ï¼šé€šè¿‡YAMLæ–‡ä»¶ç®¡ç†æ‰€æœ‰å‚æ•°
- **å®Œæ•´ç›‘æ§**ï¼šè®­ç»ƒè¿‡ç¨‹å¯è§†åŒ–å’ŒæŒ‡æ ‡è·Ÿè¸ª
- **æ–­ç‚¹ç»­è®­**ï¼šæ”¯æŒä»æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒ

### ğŸ—ï¸ æ¨¡å‹æ¶æ„
- **å…‰æµåˆ†æ”¯**ï¼šResNet-18 â†’ 2ç»´ç‰¹å¾å‘é‡
- **å…³é”®ç‚¹åˆ†æ”¯**ï¼š104ç»´è¾“å…¥ â†’ å…¨è¿æ¥ç½‘ç»œ â†’ 2ç»´ç‰¹å¾å‘é‡
- **èåˆç½‘ç»œ**ï¼š4ç»´è¾“å…¥ â†’ æœ€ç»ˆ2ç»´è¯„åˆ†è¾“å‡º

### ğŸ“Š è¾“å‡ºè¯„åˆ†
- **dynamics**ï¼šåŠ¨æ€è¯„åˆ† (0-5)
- **synkinesis**ï¼šè”åŠ¨è¯„åˆ† (0-3)

### ğŸ”„ è®­ç»ƒæµç¨‹
1. **å…‰æµé¢„è®­ç»ƒ**ï¼šå¾®è°ƒResNet-18ï¼Œç›´æ¥é¢„æµ‹è¯„åˆ†
2. **å…³é”®ç‚¹è®­ç»ƒ**ï¼šè®­ç»ƒå…¨è¿æ¥å±‚å¤„ç†104ç»´ç‰¹å¾
3. **èåˆè®­ç»ƒ**ï¼šè®­ç»ƒèåˆç½‘ç»œç»“åˆä¸¤ä¸ªæ¨¡æ€
4. **ç«¯åˆ°ç«¯å¾®è°ƒ**ï¼šå…¨å±€ä¼˜åŒ–æ‰€æœ‰å‚æ•°

## ä½¿ç”¨æ–¹å¼

### å¿«é€Ÿå¼€å§‹
```bash
# 1. å®‰è£…ç¯å¢ƒ
./install.sh

# 2. æµ‹è¯•ç»„ä»¶
python3 test_components.py

# 3. å¼€å§‹è®­ç»ƒ
python3 main.py
```

### è¿›é˜¶ä½¿ç”¨
```bash
# è‡ªå®šä¹‰é…ç½®è®­ç»ƒ
python3 main.py --config custom_config.yaml

# ä»æ£€æŸ¥ç‚¹æ¢å¤
python3 main.py --resume path/to/checkpoint.pth

# ä»…æµ‹è¯•æ•°æ®åŠ è½½
python3 main.py --test-data
```

## é…ç½®è¦ç‚¹

### æ•°æ®è·¯å¾„è®¾ç½®
```yaml
data:
  root_dir: "/home/jun/picture/output"
  face_blendshapes_model: "/home/jun/picture/extracted_models/face_blendshapes.tflite"
```

### è®­ç»ƒå‚æ•°è°ƒä¼˜
```yaml
training:
  stages:
    optical_flow_pretrain:
      epochs: 50
      learning_rate: 0.001
    # ... å…¶ä»–é˜¶æ®µ
```

### æ¨¡å‹æ¶æ„å®šåˆ¶
```yaml
model:
  optical_flow:
    backbone: "resnet18"
    dropout: 0.5
  landmark:
    hidden_dims: [256, 128, 64]
    dropout: 0.3
```

## è¾“å‡ºè¯´æ˜

è®­ç»ƒå®Œæˆåï¼Œåœ¨ `experiments/experiment_YYYYMMDD_HHMMSS/` ç›®å½•ä¸‹ä¼šç”Ÿæˆï¼š
- `best_checkpoint.pth`ï¼šæœ€ä½³æ¨¡å‹
- `training_history.json`ï¼šè®­ç»ƒå†å²
- `training_curves.png`ï¼šè®­ç»ƒæ›²çº¿å›¾
- `training_report.txt`ï¼šè®­ç»ƒæŠ¥å‘Š
- `training.log`ï¼šè¯¦ç»†æ—¥å¿—

## ç¯å¢ƒè¦æ±‚

- **Python**: 3.8+
- **PyTorch**: 1.9+
- **TensorFlow**: 2.6+ (ç”¨äºTFLite)
- **å…¶ä»–ä¾èµ–**ï¼šè§ requirements.txt

## ç¡¬ä»¶å»ºè®®

- **æœ€ä½é…ç½®**ï¼šCPU + 8GB RAM
- **æ¨èé…ç½®**ï¼šGPU + 16GB RAM
- **å­˜å‚¨ç©ºé—´**ï¼šè‡³å°‘10GBå¯ç”¨ç©ºé—´

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ä½¿ç”¨GPU**ï¼šæ˜¾è‘—åŠ é€Ÿè®­ç»ƒ
2. **é¢„åŠ è½½ç‰¹å¾**ï¼šå‡å°‘I/Oå¼€é”€
3. **åˆç†batch_size**ï¼šå¹³è¡¡å†…å­˜å’Œæ•ˆç‡
4. **æ•°æ®å¹¶è¡Œ**ï¼šå¤šGPUè®­ç»ƒæ”¯æŒ

## æ•…éšœæ’é™¤

1. **ç¯å¢ƒé—®é¢˜**ï¼šè¿è¡Œ `test_components.py` è¯Šæ–­
2. **æ•°æ®é—®é¢˜**ï¼šä½¿ç”¨ `--test-data` å‚æ•°æ£€æŸ¥
3. **å†…å­˜é—®é¢˜**ï¼šå‡å°batch_sizeæˆ–å…³é—­ç‰¹å¾é¢„åŠ è½½
4. **æ”¶æ•›é—®é¢˜**ï¼šè°ƒæ•´å­¦ä¹ ç‡å’Œè®­ç»ƒç­–ç•¥

---

âœ¨ **é¡¹ç›®å·²å®Œæ•´å®ç°ï¼Œå¯ä»¥å¼€å§‹è®­ç»ƒï¼** âœ¨
